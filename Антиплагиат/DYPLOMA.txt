МИНИСТЕРСТВО ОБРАЗОВАНИЯ РЕСПУБЛИКИ БЕЛАРУСЬ
БЕЛОРУССКИЙ ГОСУДАРСТВЕННЫЙ УНИВЕРСИТЕТ
МЕХАНИКО-МАТЕМАТИЧЕСКИЙ ФАКУЛЬТЕТ
Кафедра теоретической и прикладной механики



Распараллеленный гранично-элементный расчёт трёхмерного напряженного состояния

Дипломная работа

Дробышевского Василия
 Александровича,
 студента 4 курса специальности
 «Механика и математическое
 моделирование»
Научный руководитель:
Доктор физ.-мат. наук,
профессор Щербаков С.С.









Минск, 2022
ОГЛАВЛЕНИЕ
РЕФЕРАТ	3
РЭФЕРАТ	4
THESIS	5
ВВЕДЕНИЕ	6
ГЛАВА 1. АНАЛИТИЧЕСКОЕ РЕШЕНИЕ ЗАДАЧИ НАГРУЖЕНИЯ ПОЛУПРОСТРАНСТВА	7
1.1 Решение для сосредоточенной силы…………………………………………………………………………………...7
1.2 Решение для распределённой по прямоугольнику нагрузки................................................ 8
ГЛАВА 2. ПОСЛЕДОВАТЕЛЬНОЕ РЕШЕНИЕ О ВДАВЛИВАНИИ ПЛОСКОГО ЭЛЛИПТИЧЕСКОГО ШТАМПА В ПОЛУПРОСТРАНСТВО	24
2.1 Постановка задачи	24
2.2 Дискретизация функции поверхностного распределения	25
2.3 Получение распределения напряжений	28
2.4 Сравнение быстродействия расчетов.	17
ГЛАВА 3. РАСПАРАЛЛЕЛИВАНИЕ ПОСЛЕДОВАТЕЛЬНОГО РЕШЕНИЯ ЗАДАЧИ О ВДАВЛИВАНИИ ПЛОСКОГО ЭЛЛИПТИЧЕСКОГО ШТАМПА В ПОЛУПРОСТРАНСТВО	30
3.1 Некорторые сведения о технологии NVIDIA CUDA	30
3.2 Распараллеливание последовательного решения и сравнение результатов	32
ЗАКЛЮЧЕНИЕ	35
СПИСОК ИСПОЛЬЗУЕМОЙ ЛИТЕРАТУРЫ	36
Приложение А: листинг в программе Wolfram Mathematica для параллельного расчета статического случая неравномерного нагружения полупространства	37








РЕФЕРАТ
     В дипломной работе 28 страниц, 27 рисунков, 9 источников, 1 приложение.
     КОМПЬЮТЕРНАЯ МЕХАНИКА, ГРАНИЧНО-ЭЛЕМЕНТНОЕ МОДЕЛИРОВАНИЕ, РАСПАРАЛЛЕЛИВАНИЕ ВЫЧИСЛЕНИЙ, ТЕХНОЛОГИЯ NVIDIA CUDA, ПРОГРАММИРОВАНИЕ ГРАФИЧЕСКИХ УСКОРИТЕЛЕЙ.
     В данной дипломной работе была смоделирована задача о неравномерном нагружении полупространства. Задача была решена аналитически и численно, при решении использовалась вычислительная программа Wolfram Mathematica, с установленным пакетом CUDA Development Kit 11.7.
     По итогам работы было получено многократное ускорение расчётного времени (до 100 раз). Результаты были достигнуты при помощи встроенных в пакет Wolfram Mathematica функций, написанных с использованием технологии CUDA.
     Работа является актуальной в связи с увеличением сложности задач, рассматриваемых в рамках компьютерной механики и ограниченностью вычислительных возможностей центральных процессоров. Актуальность полученных результатов будет возрастать со временем.
      









РЭФЕРАТ
     У дыпломнай работе 28 старонак, 27 малюнкаў, 9 крыніц, 2 дадатка.
     КАМПУТАРНАЯ МЕХАНIКА, МЕЖАВА-ЭЛЕМЕНТНАЕ МАДЭЛЯВАННЕ, РАСПАРАЛЕЛЬВАННЕ ВЫЛIЧЭННАЯ, ТЭХНАЛОГIЯ NVIDIA CUDA, ПРАГРАМАВАННЕ ГРАФIЧНЫХ ПАСКАРАЛЬНIКАЎ.
     У дыпломнай працы была змадэдлявана задача пра нераўнамернае нагружанне паупространства. Задача была вырашана аналітычна і лікава, пры рашэннi выкарыстоўвалась вылічальная праграма Wolfram Mathematica, з устаноўленым пакетам CUDA Developer Toolkit 11.7.
     Па выніках працы было атрымана шматразовае скарачэнне разліковага часу (да 1500 раз). Вынiкi былi дасягнуты з дапамогай убудаваных у пакет Wolfram Mathematica функцый, напiсаных з выкарыстаннем тэхналогii CUDA.
     Праца з'яўляецца актуальнай у сувязi з павеличэннем складанасцi задач, разгляданных у рамках кампутарнай механiкi i абмежаванасцю вылiчальных магчымасцей цэнтральных працэсараў. Актуальнасць атрыманых вынiкаў будзе ўзрастаць з часам.
 
     
      









THESIS
     Diploma contains 28 pages, 27 pictures, 9 sources, 1 appendix.
     COMPUTER MECHANICS, BOUNDARY-ELEMENT MODELING, PARALLELYZING OF COMPUTATIONS, NVIDIA CUDA TECHNOLOGY, PROGRAMMING OF FRAPHICS PROCESSORS
     Problem of non-linear loading of a half-space was modeled in this diploma. This problem was solved analytically and numerically, solution was done using Wolfram Mathematica program and installed CUDA SDK 11.7.
     Based on results of the solved problem, a multiple reduction in estimating time (up to 100) was obtained. Results was achieved using built-in in Wolfram Mathematica functions, which written using CUDA technology.
     This work is relevant in connection with growth of problems difficulty under computer mechanics consideration and limitation of computational possibilities of central processors. The relevance of the results obtained will increase over time.
     
     
     
     
     
     
     
     
     
     
     
     
ВВЕДЕНИЕ
     Современные задачи деформируемого твёрдого тела, которые компьютерная механика ставит перед инженерами, требуют качественного анализа сложных систем. Такой анализ может быть ограничен временем расчёта напряженно-деформированного состояния рассматриваемой системы для заданного набора входных параметров. Например, расчёт режущего аппарата сельскохозяйственного комбайна или системы типа колесо-рельс [1,2] с помощью распространённых пакетов конечно-элементного моделирования, таких как Ansys, SOLIDWORKS, NX NASTRAN и т.д. может длится около недели.
     Так как при использовании наиболее популярного метода численного моделирования подобных задач — Метода Конечных Элементов особенностью аппроксимации является связь, между соседними узлами расчётной сетки, то распараллеливание расчёта на ядрах центрального процессора обеспечивает сокращение времени вычислений не более чем в 2-4 раза. Такой вывод приводит к необходимости поиска новых возможностей для ускорения вычислений.
     При гранично-элементной аппроксимации рассматриваются граничные интегральные уравнения, которые позволяют производить расчёт взаимных влияний граничных элементов (расчётных узлов) независимо друг от друга, таким образом формируя матрицу системы линейных алгебраических уравнений [3 — 5]. Следовательно, при моделировании задач гранично-элементным методом, все искомые значения могут быть определены параллельно [6].
     Целью работы является решение задачи о вдавливании плоского эллиптического штампа в полупространство методом граничных элементов последовательно, распараллеливание этого решения и сравнение времени, необходимо на оба решения.
     
     
     


ГЛАВА 1
АНАЛИТИЧЕСКОЕ РЕШЕНИЕ ЗАДАЧИ НАГРУЖЕНИЯ ПОЛУПРОСТРАНСТВА
1.1 Решение для сосредоточенной силы
     Рассмотрим задачу нагружения трёхмерного полупространства, которое является однородной изотропной упругой средой, нагрузкой, распределённой по прямоугольной области, при этом нагрузка действует вдоль вертикальной оси. Необходимо аналитически определить напряженно-деформированное состояние среды, получить общую формулу для расчёта элементов тензора напряжений и вектора перемещений.
     Рассмотрим для начала аналогичную задачу для сосредоточенной силы. после чего полученные решения проинтегрируем по заданному прямоугольнику.
     Полученное Кельвином решение для сосредоточенной силы, действующей в данной среде, имеет вид:
    u_i (x)=G_ij (x,?)*e_(j) (?), 
где e_j (?) — единичные силы, приложенные в точке ?_j и направленные по осям декартовой системы координат x_i, причём
    G_ij (x,?)=1/16??(1-?) *1/r ((3-4?) ?_ij+(y_i y_j)/r^2 ), 
Здесь ? и ? — модуль сдвига и коэффициент Пуассона среды соответственно и 
y_i=x_i-?_i,r^2=y_i*y_i,
r=?(?x_1?^2+?x_2?^2+?x_3?^2 ).
Компоненты тензора напряжений определяются следующим образом:
?_ij (x)=T_ijk (x,?)e_k (?), где
T_ijk (x,?)=-1/8?(1-?)   1/r^2  ((?_ik  y_j/r+?_jk  y_i/r-?_ij  y_k/r)(1-2?)+(3y_i y_j y_k)/r^3 ). 

1.2 Решение для распределённой по прямоугольнику нагрузки
     После того, как нами было получено решение задачи о точечном нагружении полупространства, рассмотрим аналогичную задачу, с тем лишь изменением, что теперь будем прикладывать к данной среде нагрузку, распределённую по прямоугольнику. Для этого воспользуемся решениями, полученными в предыдущем пункте. Дважды проинтегрируем решения Кельвина для компонент тензора напряжений и вектора перемещений.
     Решение для ?_3,3:
    ??_3,3?^I (x,y,z,a,b)=?_(-a)^a???_3,3 (x-p,y,z,a,b)?p?,
??_3,3?^II (x,y,z,a,b)=?_(-b)^b????_3,3?^I (x,y-k,z,a,b)?k=  ?  (p_0 x_3 (?+?))/(4?(?+2?))(-(x_1 x_2 (?x_1?^2+?x_2?^2+2?x_3?^2))/((?x_1?^2+?x_3?^2)(?x_2?^2+?x_3?^2)?(?x_1?^2+?x_2?^2+?x_3?^2 ))+((-a+x_1)x_2 (?(-a+x_1)?^2+?x_2?^2+2?x_3?^2))/((?(-a+x_1)?^2+?x_3?^2)(?x_2?^2+?x_3?^2)?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 ))+(x_1 (-b+x_2)(?x_1?^2+?(-b+x_2)?^2+2?x_3?^2))/((?x_1?^2+?x_3?^2)(?(-b+x_2)?^2+?x_3?^2)?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 ))+((a-x_1)(-b+x_2)(?(-a+x_1)?^2+?(-b+x_2)?^2+2?x_3?^2))/((?(-a+x_1)?^2+?x_3?^2)(?(-b+x_2)?^2+?x_3?^2)?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 )))+p_0/4?(-arctg[(x_1 x_2)/(x_3 ?(?x_1?^2+?x_2?^2+?x_3?^2 ))]+arctg[((-a+x_1)x_2)/(x_3 ?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 ))]+arctg[(x_1 (-b+x_2))/(x_3 ?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 ))]-arctg[((-a+x_1)(-b+x_2))/(x_3 ?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 ))]) .
     Теперь проинициализируем постоянные, описывающие поведение среды и построим графики напряжений при фиксированных x_3 и x_2:
     E=10^10;?=0,3; ?=(? E)/((1+?)(1-2?));?=E/(2(1+?));
     Для a=1; b=0,7; p_0= 100;x ? (-1, 1);y ? (-1, 1); график распределения напряжений будет выглядеть следующим образом.

Рисунок 1.1 Распределение ?_3,3 в полупространстве при фиксированном x_3

Рисунок 1.2 Распределение ?_3,3 в полупространстве при фиксированном x_2

     Решение для ?_1,1:
    ??_1,1?^I (x,y,z,a,b)=?_(-a)^a???_1,1 (x-p,y,z,a,b)?p?,
??_1,1?^II (x,y,z,a,b)=?_(-b)^b????_1,1?^I (x,y-k,z,a,b)?k=  ?  p_0/4?(?+2?) *(x_3 (?+?)((x_1 x_2)/((?x_1?^2+?x_3?^2)?(?x_1?^2+?x_2?^2+?x_3?^2 ))-((-a+x_1)x_2)/((?(-a+x_1)?^2+?x_3?^2)?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 ))-(x_1 (-b+x_2))/((?x_1?^2+?x_3?^2)?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 ))+((-a+x_1)(-b+x_2))/((?(-a+x_1)?^2+?x_3?^2)?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 )))+?(-arctg[(x_1 x_2)/(x_3 ?(?x_1?^2+?x_2?^2+?x_3?^2 ))]+arctg[((-a+x_1)x_2)/(x_3 ?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 ))]+arctg[(x_1 (-b+x_2))/(x_3 ?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 ))]-arctg[((-a+x_1)(-b+x_2))/(x_3 ?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 ))])) .
Построим графики напряжений при фиксированных x_3 и x_2:

Рисунок 1.3 Распределение ?_1,1 в полупространстве при фиксированном x_3

Рисунок 1.4 Распределение ?_1,1 в полупространстве при фиксированном x_2
Решение для ?_1,2:
??_1,2?^I (x,y,z,a,b)=?_(-a)^a???_1,2 (x-p,y,z,a,b)?p?,
??_1,2?^II (x,y,z,a,b)=?_(-b)^b????_1,2?^I (x,y-k,z,a,b)?k=  ?  (p_0 x_3 (?+?))/(4?(?+2?))*(-1/?(?x_1?^2+?x_2?^2+?x_3?^2 )+1/?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 )+1/?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 )-1/?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 )).
Построим графики напряжений при фиксированных x_3 и x_2:

Рисунок 1.5 Распределение ?_1,2 в полупространстве при фиксированном x_3
Решение для ?_1,3:
    ??_1,3?^I (x,y,z,a,b)=?_(-a)^a???_1,3 (x-p,y,z,a,b)?p?,
??_1,3?^II (x,y,z,a,b)=?_(-b)^b????_1,3?^I (x,y-k,z,a,b)?k=  ?  p_0/(4?(?+2?))((?+?)*((x_2 ?x_3?^2)/((?x_1?^2+?x_3?^2)?(?x_1?^2+?x_2?^2+?x_3?^2 ))-(x_2 ?x_3?^2)/((?(-a+x_1)?^2+?x_3?^2)?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 ))-((-b+x_2)?x_3?^2)/((?x_1?^2+?x_3?^2)?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 ))+((-b+x_2)?x_3?^2)/((?(-a+x_1)?^2+?x_3?^2)?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 )))+?(log[x_2+?(?x_1?^2+?x_2?^2+?x_3?^2 )]-log[x_2+?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 )]-log[-b+x_2+?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 )]+log[-b+x_2+?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 )])).
Построим графики напряжений при фиксированных x_3 и x_2:

Рисунок 1.6 Распределение ?_1,3 в полупространстве при фиксированном x_3

Рисунок 1.7 Распределение ?_1,3 в полупространстве при фиксированном x_2
Решение для ?_2,2:
    ??_2,2?^I (x,y,z,a,b)=?_(-a)^a???_2,2 (x-p,y,z,a,b)?p?,
??_2,2?^II (x,y,z,a,b)=?_(-b)^b????_2,2?^I (x,y-k,z,a,b)?k=  ?  p_0/(4?(?+2?))*(x_3 (?+?)((x_1 x_2)/((?x_2?^2+?x_3?^2)?(?x_1?^2+?x_2?^2+?x_3?^2 ))-((-a+x_1)x_2)/((?x_2?^2+?x_3?^2)?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 ))-(x_1 (-b+x_2))/((?(-b+x_2)?^2+?x_3?^2)?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 ))+((-a+x_1)(-b+x_2))/((?(-b+x_2)?^2+?x_3?^2)?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 )))+?(-arctg[(x_1 x_2)/(x_3 ?(?x_1?^2+?x_2?^2+?x_3?^2 ))]+arctg[((-a+x_1)x_2)/(x_3 ?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 ))]+arctg[(x_1 (-b+x_2))/(x_3 ?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 ))]-arctg[((-a+x_1)(-b+x_2))/(x_3 ?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 ))])).
Построим графики напряжений при фиксированных x_3 и x_2:

Рисунок 1.8 Распределение ?_2,2 в полупространстве при фиксированном x_3

Рисунок 1.9 Распределение ?_2,2 в полупространстве при фиксированном x_2
Решение для ?_2,3:
    ??_2,3?^I (x,y,z,a,b)=?_(-a)^a???_2,3 (x-p,y,z,a,b)?p?,
??_2,3?^II (x,y,z,a,b)=?_(-b)^b????_2,3?^I (x,y-k,z,a,b)?k=  ?  p_0/(4?(?+2?))*((?+?)((x_1 ?x_3?^2)/((?x_2?^2+?x_3?^2)?(?x_1?^2+?x_2?^2+?x_3?^2 ))-((-a+x_1)?x_3?^2)/((?x_2?^2+?x_3?^2)?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 ))-(x_1 ?x_3?^2)/((?(-b+x_2)?^2+?x_3?^2)?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 ))+((-a+x_1)?x_3?^2)/((?(-b+x_2)?^2+?x_3?^2)?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 )))+?(log[x_1+?(?x_1?^2+?x_2?^2+?x_3?^2 )]-log[-a+x_1+?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 )]-log[x_1+?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 )]+Log[-a+x_1+?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 )])).
Построим графики напряжений при фиксированных x_3 и x_2:

Рисунок 1.10 Распределение ?_2,3 в полупространстве при фиксированном x_3

Рисунок 1.11 Распределение ?_2,3 в полупространстве при фиксированном x_2
Решение для U_1:
    ?U_1?^I (x,y,z,a,b)=?_(-a)^a??U_1 (x-p,y,z,a,b)?p?,
?U_1?^II (x,y,z,a,b)=?_(-b)^b???U_1?^I (x,y-k,z,a,b)?k=  ?-(p_0 x_3 (?+?))/(8??(?+2?))*(log[x_2+?(?x_1?^2+?x_2?^2+?x_3?^2 )]-log[x_2+?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 )]-log[-b+x_2+?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 )]+log[-b+x_2+?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 )]).
Построим графики перемещений при фиксированных x_3 и x_2:

Рисунок 1.12 Распределение U_1 в полупространстве при фиксированном x_3

Рисунок 1.13 Распределение U_1 в полупространстве при фиксированном x_2
Решение для U_2:
    ?U_2?^I (x,y,z,a,b)=?_(-a)^a??U_2 (x-p,y,z,a,b)?p?,
?U_2?^II (x,y,z,a,b)=?_(-b)^b???U_2?^I (x,y-k,z,a,b)?k=  ?-(p_0 x_3 (?+?))/(8??(?+2?))*(log[x_1+?(?x_1?^2+?x_2?^2+?x_3?^2 )]-log[-a+x_1+?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 )]-log[x_1+?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 )]+log[-a+x_1+?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 )]).
Построим графики перемещений при фиксированных x_3 и x_1:

Рисунок 1.14 Распределение U_2 в полупространстве при фиксированном x_3

Рисунок 1.15 Распределение U_2 в полупространстве при фиксированном x_1
Решение для U_3:
    ?U_3?^I (x,y,z,a,b)=?_(-a)^a??U_3 (x-p,y,z,a,b)?p?,
?U_3?^II (x,y,z,a,b)=?_(-b)^b???U_3?^I (x,y-k,z,a,b)?k=  ?  p_0/(8??(?+2?))*(2x_3 ?(-arctg[(x_1 x_2)/(x_3 ?(?x_1?^2+?x_2?^2+?x_3?^2 ))]+arctg[((-a+x_1)x_2)/(x_3 ?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 ))]+arctg[(x_1 (-b+x_2))/(x_3 ?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 ))]-arctg[((-a+x_1)(-b+x_2))/(x_3 ?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 ))])+(?+3?)(x_2 (log[x_1+?(?x_1?^2+?x_2?^2+?x_3?^2 )]-log[-a+x_1+?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 )])+x_1 (log[x_2+?(?x_1?^2+?x_2?^2+?x_3?^2 )]-log[-b+x_2+?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 )])+(-b+x_2)(-log[x_1+?(?x_1?^2+?(-b+x_2)?^2+?x_3?^2 )]+log[-a+x_1+?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 )])+(-a+x_1)(-Log[x_2+?(?(-a+x_1)?^2+?x_2?^2+?x_3?^2 )]+log[-b+x_2+?(?(-a+x_1)?^2+?(-b+x_2)?^2+?x_3?^2 )]))).

Рисунок 1.16 Распределение U_3 в полупространстве при фиксированном x_3

Рисунок 1.17 Распределение U_3 в полупространстве при фиксированном x_2


ГЛАВА 2
ПОСЛЕДОВАТЕЛЬНОЕ РЕШЕНИЕ ЗАДАЧИ О ВДАВЛИВАНИИ ПЛОСКОГО ЭЛЛИПТИЧЕСКОГО ШТАМПА В ПОЛУПРОСТРАНСТВО
2.1 Постановка задачи
     Теперь рассмотрим случай нагружения полупространства по эллиптической области, задающееся следующим образом (рис 2.1):
U?— (x,y,a,b,U_0)=U_0,?(x/a)?^2+?(y/b)?^2?1 


Рисунок 2.1 Функция распределения перемещений
     Решение данной граничной задачи сводится к определению фиктивных усилий s?_^*, приложив которые на границе полупространства, удовлетворим граничные условия. Решим данную задачу используя с помощью Метода Граничных Элементов. Для этого дискретизируем полученную функцию перемещения на граничные элементы.
    2.2 Дискретизация функции поверхностного распределения
     Как и при любой дискретизации, очевидно, что общее количество элементов будет зависеть от размера элемента, учитывая, что выбрана равномерная сетка, с одинаковыми размерами каждого граничного элемента, это количество будет выражаться следующим образом.
     n=2s/h+1,
где n – количество элементов вдоль одной оси, s – размер расчётной области, h – размер граничного элемента, N=n^2 – общее количество элементов.
     При решении данной задачи, для того чтобы в будущем иметь возможность проводить сравнительный анализ решений, рассмотрим 4 различных случая разбиения функции распределения перемещений: n = 20, n = 40, n = 60, n = 80. Определение массива элементов вдоль одной оси происходит динамически: сначала задаётся размер граничного элемента, после чего определяется их количество и в конце производится разбиение расчётной области с шагом, равным размеру граничного элемента. Таким образом вся область разбита на сетку. Так же приведём графики дискретизации функции поверхностного распределения для всех случаев.
     
     Рисунок 2.2 Дискретизация функции поверхностного распределения при n = 20
     
     Рисунок 2.3 Дискретизация функции поверхностного распределения при n = 40
     
     Рисунок 2.4 Дискретизация функции поверхностного распределения при n = 60
     
     
     Рисунок 2.3 Дискретизация функции поверхностного распределения при n = 80
    2.3 Получение распределения напряжений
     Получив значение функции перемещений, внутри эллиптической области, необходимо получить значение давлений в точке, как суперпозицию перемещений от каждого граничного элемента. Значение будем искать в виде суммы всех действующих на точку граничных элементов.
                         p(x_i,y_j  )=?_(i=1)^k??p_j^* ??*U?_3?^II (x-x_i,y-y_j,z,a,b) ?,               
где p_j^* —искомые значения, k — количество элементов внутри эллипса.
Исходя из этого построим систему линейных алгебраических уравнений, состоящую из k уравнений и имеющую k переменных, подставляя в функцию p(x_i,y_j  ) значения координат узлов граничных элементов. 
     Решим эту систему матричным методом, для этого составим уравнение вида
                                                                      Ax=B,                                                             
где A – матрица, составленная из функций p(x_i,y_j  ), x — столбец, состоящий из искомых значений усилий и B – столбец, полученный уплощением матрицы дискретизации функции перемещений. Отобразим на рисунках картины распределения фиктивных усилий для двух вариантов дискретизации полупространства:
     
     
     Рисунок 2.4 Распределение фиктивных усилий при n = 40
     
     
     Рисунок 2.4 Распределение фиктивных усилий при n = 60
     
     Далее построим распределение перемещений на поверхности полупространства, приложив к нему фиктивные усилия
     
     Проведём расчёт фиктивных усилий для того, чтобы убедиться, что полученные значения потенциала верны. Подставим полученные значения потенциала в функцию p(x,y,z,a,b), найдём её значение в каждом узле граничных элементов и построим график полученных данных.
     
     Рисунок 2.5 Распределение фиктивных усилий
    ГЛАВА 3
    РАСПАРАЛЛЕЛИВАНИЕ ПОСЛЕДОВАТЬЕЛЬНОГО РЕШЕНИЯ ЗАДАЧИ О ВДАВЛИВАНИИ ПЛОСКОГО ЭЛЛИПТИЧЕСКОГО ШТАМПА В ПОЛУПРОСТРАНСТВО
    3.1 Некоторые сведения о технологии NVIDIA CUDA
     Благодаря оптимизации, современное программное обеспечение способно показать значительные результаты в области сокращения временных затрат на выполнение математических операций и вычислений, однако даже самые мощные процессоры постепенно приближаются к своему пределу, связанному с ограниченностью размера техпроцесса. Единственным решением сложных и громоздких задач является объединение таких процессоров в кластеры для их одновременной работы. Однако для обычных пользователей существуют ограничения, связанные с невозможностью использования таких кластеров или мощных самих по себе центральных процессоров, которые используются в качестве основных вычислительных единиц.
     Одним из немногих оптимальных решений проблемы ускорения вычислений становятся графические процессоры, в частности те, которые поддерживают работу с технологией NVIDIA CUDA. Эта технология предоставляет возможность взаимодействия с ядрами и памятью GPU (графического ускорителя), с целью ускорения вычислений.
     Первоначальная версия CUDA Software Development Kit была представлена в феврале 2007 года. Основой API (Интерфейс Программирования Приложений) CUDA стал язык Cи, с необходимыми расширениями. В состав CUDA входит собственный Си-компилятор командной строки nvcc, созданный компанией Nvidia на основе компилятора Open64. Данная технология применима не только для производительных графических вычислений: помимо всего прочего, CUDA используют в различных областях: моделирование динамики жидкостей, астрофизика, электромагнитные взаимодействия, химия, вычислительная биология и т.д. Отдельно стоит упомянуть, что работу с CUDA поддерживают такие операционные системы как Linux, Windows и Mac OS, что делает её кроссплатформенной технологией.
     CUDA как платформа впервые появилась на рынке с выходом чипа восьмого поколения G80, после чего стала появляться во всех последующих сериях графических чипах, используемых в семействе GeForce, Tesla и Quadro. Графических процессор организует аппаратную многопоточность, позволяя использовать больше ресурсов графического ускорителя. Так стало возможно делегировать функции физического ускорителя на графический, примером такой реализации стал PhysX.
     Единицами вычисления графический ускоритель являются сеть, блок и нить. Наивысшая единица вычислительной архитектуры — сеть, она состоит из блоков, а те, в свою очередь, из нитей. Нить — самая маленькая вычислительная единица. Следовательно, используя графический процессор, можно запустить N_блоков?N_(нитей в одном блоке) параллельных вычислений. Сеть обычного GPU может состоять из 65535 блоков, в каждом из которых можно запустить 1024 нити. Произведя подсчёт, получим возможность запустить 6710784 параллельно работающих единиц. Для дальнейшей работы с вычислительными единицами существует возможность получить следующую информацию о конфигурации нитей, блоков и сети:
    * gridDim.x, gridDim.y, gridDim.z — размерность сети блоков вдоль каждого из измерений соответственно;
    * blockDim.x, blockDim.x, blockDim.x, — размерность блока вдоль каждого из измерений соответственно;
    * blockIdx.x, blockIdx.y, blockIdx.z — индекс блока внутри сети вдоль каждого из измерений соответственно;
    * threadIdx.x, threadIdx.y, threadIdx.z — индекс нити внутри блока вдоль каждого из измерений соответственно.

Рисунок 3.1 Организация вычислительных единиц на графическом процессоре
3.2 Распараллеливание последовательного решения и сравнение результатов
     Последовательное решение задачи, рассмотренное в предыдущей главе возможно распараллелить несколькими способами. Например, при решении СЛАУ матричным методом воспользуемся функцией CUDADot[], которая позволяет перемножить два двумерных массива, предварительно загруженных в память графического ускорителя, для загрузки в память будем использовать функцию CUDAMemoryLoad[]. Также решим задачу о вдавливании эллиптического штампа в полупространство для всех дискретизаций функции поверхностного распределения и проведём сравнительный анализ скорости решения.
     При выполнении параллельных расчётов были выбраны следующие значения размера граничных элементов для дискретизации ими полупространства: 3/19, 3/39, 3/59, 3/79
Соответственно, расчёты проводились для 20, 40, 60 и 80 граничных элементов, а также для 400, 1600, 3600, 6400 расчётных узлов. Для вычислений использовался компьютер на базе центрального процессора Intel Core i5 8400, с тактовой частотой 3800 МГц, объёмом оперативной памяти DDR3 8 Гб и графического адаптера NVIDIA GeForce GTX 1050Ti.
     Из рисунка видно, что при решении СЛАУ ускорение параллельных вычислений растёт практически линейно по сравнению с последовательными, с увеличением количества граничных элементов. Для 80 граничных элементов ускорение решения СЛАУ составило примерно 64 раза (для 6400 граничных элементов в пространстве)

Рисунок 3.2 Сравнивание временных затрат при решении СЛАУ матричным методом последовательно (чёрная линия) и с помощью CUDADot[] параллельно (красная линия)
Получив данные о затраченном на решение задачи времени, построим график ускорения расчёта фиктивных усилий в полупространстве.


Рисунок 3.3 Коэффициенты ускорения расчётов при решении СЛАУ матричным методом.














ЗАКЛЮЧЕНИЕ
     Методом граничных элементов была решена задача о неравномерном стационарном нагружении поверхности полупространства давлением с эллиптическим распределением. Так же были продемонстрированы результаты для нагружения полупространства по прямоугольной области, были приведены графики шести независимых компонент тензора напряжений и 3 компонент вектора перемещений.
     Распределение усилий полупространства было получено на основе последовательных и параллельных вычислений с использованием технологии Nvidia Cuda.
     В результате было получено уменьшение времени расчетов. Для 6400 граничных элементов было получено ускорение последовательных вычислений в 101 раз при расчёте распределения давления на поверхности полупространства.
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    СПИСОК ИСПОЛЬЗУЕМОЙ ЛИТЕРАТУРЫ
1. Щербаков, С.С., Напряженно-деформированное состояние и объемная повреждаемость в окрестности контактного взаимодействия в трибофатической системе колесо / рельс с учетом неконтактного деформирования рельса / С.С. Щербаков, О.А. Насань // Вестник БелГУТа: Наука и транспорт. – 2016. – № 1 (32). – С. 234–247
2. Журавков, М.А. Объемная повреждаемость динамически нагруженных элементов режущего инструмента сельскохозяйственного комбайна / Журавков М.А., Щербаков С.С., Насань О.А. // Теоретическая и прикладная механика: Межведомственный сборник научно-методических статей. –Вып.30. –Минск: БНТУ, –2015. – С. 297 – 305.
3. Бенерджи, П. Метод граничных элементов в прикладных науках / П. Бенерджи, Р. Баттерфилд – М: Мир, 1984. – 494 с.
4. Крауч, С  Методы граничных элементов в механике твердого тела / С. Крауч, А. Старфилд – М:Мир, 1987. – 328 с.
5. Beer, G. Boundary element method with programming / G. Beer, I. Smith, Duenser C. – Springer, 2008. – 494 p.
6. Журавков, М.А. Гранично-элементное моделирование с использованием элементов с квадратичным распределением усилий и распараллеливаением вычислений / М.А. Журавков, А.В. Круподеров, С.С. Щербаков // Теоретическая и прикладная механика: Межведомственный сборник научно-методических статей. –Вып.29. –Минск: БНТУ, –2014. –С.105-110.
7. http://www.nvidia.ru/object/cuda_home_new.html
8. Jason Sanders. CUDA by Example: An Introduction to General-Purpose GPU Programming 1st Edition.
9. Щербаков С.С., Сергеев В.Э. Применение технологии CUDA для распараллеливания гранично-элементных вычислений. // Теоретическая и прикладная механика. Международный научно-технический сборник. Вып.32. Минск: БНТУ, 2017. С. 330 — 335.
    Приложение А: листинг кода в программе Wolfram Mathematica для расчёта задачи о вдавливании эллиптического штампа в полупространство

2


